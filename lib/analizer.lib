//-----------------------------------------------
// vocoder analizer
//-----------------------------------------------

subLevel(audio) = voice(audio):gate_mono(threshold-15,0,0.1,0.05):lowpass(3,300):amp_follower_ud(0.003,0.005)*4:tanh;

//subLevel(audio) = audio:lowpass(3,300):amp_follower_ud((vslider("up", 0, 0, 1, 0)*0.1),(vslider("down", 0, 0, 1, 0.001)*0.1))*6:tanh;

//analizerCenters(freq) = VocoderFreqs(0.853553,128):(par(i,nrBands, _,freq:*:min(SR/2)));

analizerCenters(freq) = VocoderFreqs(analizerBottom ,analizerTop):(par(i,nrBands, _,freq:*:min(SR/2)));

//amp_follower_ud params set for minimal distortion
//also sounds cool to vary between this and 0

bandEnv=resonbp(analizerQ,1):amp_follower_ud(0.002,0.004);

analizers=
interleave(nrBands,4):par(i, nrBands,(resonbp:amp_follower_ud(0.002,0.004)));


analizer(audio,freq)=(analizerCenters(freq),(analizerQ<:bus(nrBands)),(1<:bus(nrBands)),(audio<:bus(nrBands))):analizers;


